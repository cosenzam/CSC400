{% extends "base.html" %}
{% block title %}Post {{post_id}}{% endblock %}
{% block content %}

{% with messages = get_flashed_messages() %}
        {% if messages %}
            {% for msg in messages %}
                <p class="text-center">{{msg}}</p>
            {% endfor %}
        {% endif %}
{% endwith %}
{% set current_user = get_user(post.user_id) %}
<!-- parent post -->
<div class="row justify-content-center post">
    <span class="col-sm-4 border" style="word-wrap: break-word">
        <img src="/static/images/kitten.jpg" class="media-object" style="height:60px; width:60px; float:left">
        <p style="text-align: left;">
            &emsp;{{current_user.user_name}}&emsp;{{postDateFormat(post, getPostRecency(post))}}
        </p>
        <br>
        <p>{{post.text}}</p>
        <div class="text-center">
            {% if not post.is_liked(current_user) %}
                <a id="like_{{ post.id }}" onclick="ajax_like('{{post.id}}');event.stopPropagation();" class="btn bi bi-heart post-icon tt like" data-bs-placement="bottom" title="Like" style="float: left;"></a>
            {% elif post.is_liked(current_user) %}
                <a id="like_{{ post.id }}" onclick="ajax_like('{{post.id}}');event.stopPropagation();" class="btn bi bi-heart-fill post-icon tt like" data-bs-placement="bottom" title="Unlike" style="float: left; color: red;"></a>
            {% endif %}
            <span class="btn bi bi-arrow-repeat post-icon tt share" data-bs-placement="bottom" title="Share"></span>

            <a type="button" class="btn bi bi-reply post-icon tt reply" data-bs-placement="bottom" title="Reply" style="float: right;"
            data-bs-toggle="modal" data-bs-target="#replyModal"></a>

            <div class="modal fade" id="replyModal" tabindex="-1" role="dialog" aria-labelledby="postModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content bg-dark text-light">
                        <div class="modal-header">
                            <h5 class="modal-title" id="replyModalLabel">Replying to {{current_user.user_name}}</h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form action="#" method="post" enctype="multipart/form-data">
                                {{form.csrf_token}}
                                <p>{{form.text.label}}</p>
                                <p>{{form.text(size=20)}}</p>
                                <p>{{form.media.label}}</p>
                                <p>{{form.media(size=20)}}</p>
                                <div class="modal-footer">
                                    <button type="submit" class="btn btn-light text-dark">Submit Reply</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </span>
</div>

        <!-- child posts (these will be looped though and return url_for('view_post') when post body or reply is clicked) -->
        
{% endblock %}